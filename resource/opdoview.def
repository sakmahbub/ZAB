product ZAB

table opdoview
  caption "Sales Return View"
  columns ztime,zutime,zauserid,zuuserid,zid

  primary key zid,xdornum

  foreign key
        zid references zbusiness.zid
        //zid,xsm,xrsm references carsm.zid,xsm,xrsm
  end foreign key

  sql create view opdoview(zid,xdornum,xdate,xitem,xwh,xrate,xvaterate,xsm,xrsm,xfm,xsp,xpp,xqty,xqtybonus,xdiscetamt) ~
	as select dt.zid,hd.xdornum,hd.xdate,xitem,hd.xwh,dt.xrate,dt.xvatrate,hd.xsm,hd.xrsm,hd.xfm,hd.xsp,hd.xpp,sum(dt.xqtyord),sum(dt.xqtybonus),sum(dt.xdiscdetamt) ~
	from opdodetail dt ~
	inner join opdoheader hd on dt.xdornum=hd.xdornum ~
	group by dt.zid,hd.xdornum,hd.xdate,xitem,hd.xwh,dt.xrate,dt.xvatrate, hd.xsm,hd.xrsm,hd.xfm,hd.xsp,hd.xpp 
end table
