product ZAB

table ophdsumview
  caption "Actual"
  columns ztime,zutime,zauserid,zuuserid,zid

  primary key zid,xdornum

  foreign key
        zid references zbusiness.zid
        //zid,xsm,xrsm references carsm.zid,xsm,xrsm
  end foreign key

  sql create view ophdsumview(zid,xdornum,xdate,xcrnnum,xdatertn,xcus,xorg,xpp,xroute,xname,xwh,xretamt,xtotamt,xvatamt,xdiscamt,xdatedel) ~
    as select hd.zid,hd.xdornum,hd.xdate,'',hd.xdate,hd.xcus,ca.xorg,hd.xpp,hd.xroute,sp.xname,hd.xwh, ~
    hd.xtotamt as xtotamt, ~
    hd.xvatamt as xvatamt, ~
    hd.xdiscamt,temptable.xretamt hd.xdatedel ~
    from opdoheader hd ~
    inner join cacus ca on hd.zid=ca.zid and hd.xcus=ca.xcus ~
    inner join cappo sp on hd.zid=sp.zid and hd.xpp=sp.xsp ~
    left join (select zid,xdornum,sum((xqtytr-xqtyord)*xrate) as xretamt from opdodetail group by zid,xdornum) temptable on temptable.zid=hd.zid and ~
    temptable.xdornum=hd.xdornum 


end table
