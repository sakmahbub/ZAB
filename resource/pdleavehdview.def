
product ZAB ERP

table pdleavehdview
  caption "Available Leave View"
  columns zid,xvoucher,xrow,xyear,xper,xdate,xstaff,xtype,xamount,xpercent,xqty,xtrntype,xlong,xposition

  primary key zid,xvoucher,xrow

  foreign key
    zid references zbusiness.zid
  end foreign key

  sql create view pdleavehdview (zid,xyearperdate,xstaff,xposition,xname,xdate,xtypeleave,xdatefrom,xdateto,xday,xappday,xstatus,xpaidleave,xsid, ~
								xsuperior2,xsuperior3,xsignatory1,xsignatory2,xsignatory3,xsigndate1,xsigndate2,xsigndate3,xyear,xdesignation,~
								xdeptname,xadminid,xdaymonth,xnote,xnote1)~
                  as select h.zid,h.xyearperdate,h.xstaff,h.xposition,m.xname,h.xdate,h.xtypeleave,h.xdatefrom,h.xdateto, ~
						Case when h.xstatus='Confirmed' then h.xday else 0 end, ~
						h.xappday,h.xstatus,h.xpaidleave,isnull(h.xsid,'') as xsid, ~ 
						h.xsuperior2,h.xsuperior3, ~
						h.xsignatory1,h.xsignatory2,h.xsignatory3,h.xsigndate1,h.xsigndate2,h.xsigndate3,h.xyear,m.xdesignation,m.xdeptname,m.xadminid, ~
						CAST(CONCAT(SUBSTRING(Convert(varchar,CAST(h.xdatefrom AS DATE)),1,4), ~
						SUBSTRING(Convert(varchar,CAST(h.xdatefrom AS DATE)),6,2), ~
						SUBSTRING(Convert(varchar,CAST(h.xdatefrom AS DATE)),9,2)) AS INT),h.xnote,h.xnote1 ~
						from pdleaveheader h inner join pdmst m on h.zid=m.zid and h.xstaff=m.xstaff

end table
