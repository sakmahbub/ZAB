
product ZAB ERP

table pdprocsview
  caption "Process View"
  columns zid,xstaff,xrow,xyear,xper,xtype,xamount,xpercent,xqty,xarrear,xadjustment,~
          xothours,xtrntype,xcomptype,xdesc

  primary key zid,xstaff,xrow

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view pdprocsview (zid,xstaff,xrow,xyear,xper,xtype,xamount,xpercent,xqty,xarrear,xadjustment,~
                  xothours,xtrntype,xcomptype,xdesc)~
                  as select a.zid,a.xstaff,a.xrow,0,0,a.xtype,isnull(a.xamount,0),0,0,0,0,0,~
                  (select xprops from xcodes where xtype='PD Transaction Type' and xcode=a.xtype),~
                  (select xlong from xcodes where xtype='PD Transaction Type' and xcode=a.xtype),~
                  'pdsalarydetail' ~
                  from pdsalarydetail a join pdmst b on a.zid=b.zid and a.xstaff=b.xstaff union all ~
                  select a.zid,b.xstaff,a.xrow,b.xyear,b.xper,a.xtype,isnull(a.xamount,0),isnull(xpercent,0),isnull(xqty,0),~
                  isnull(xarrear,0),isnull(xadjustment,0),isnull(xothours,0),~
                  (select xprops from xcodes where xtype='PD Transaction Type' and xcode=a.xtype),~
                  (select xlong from xcodes where xtype='PD Transaction Type' and xcode=a.xtype),~
                  'pdtrndetail' ~
                  from pdtrndetail a join pdtrnheader b on a.zid=b.zid and a.xvoucher=b.xvoucher
end table
