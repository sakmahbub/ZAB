product ZAB ERP

table imtransactionarcview
  caption "AR Report View"
  columns zid,ximtrnnum, xitem,xwh,xdesc,xdate,~
          xqty,xval,xvalpost,xdocnum,xdocrow,xnote,~
          xsign,xunit,xrate,xref,xstatusjv

  primary key zid,xvoucher

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view imtransactionarcview(zid,ximtrnnum, xitem,xwh,xdesc,xdate,xqty,xval,xvalpost,xdocnum,xdocrow,xnote,~
                                    xsign,xunit,xrate,xref,xstatusjv) ~
                                    as select a.zid,a.ximtrnnum, a.xitem,a.xwh,~
                                    (select xlong from xcodes where xtype='Branch' and zid=a.zid and xcode=a.xwh),~
                                    a.xdate,a.xqty,a.xval,a.xvalpost,a.xdocnum,a.xdocrow,a.xnote,~
                                    a.xsign,a.xunit,a.xrate,a.xref,a.xstatusjv ~
                                    from imtrn a join xcodes b on a.zid=b.zid and a.xwh=b.xcode and b.xtype='Branch' ~
UNION ALL ~
				select c.zid,c.ximtrnnum,c.xitem,c.xwh,~
                                    (select xlong from xcodes where xtype='Branch' and zid=c.zid and xcode=c.xwh),~
                                    c.xdate,c.xqty,c.xval,c.xvalpost,c.xdocnum,c.xdocrow,c.xnote,~
                                    c.xsign,c.xunit,c.xrate,c.xref,c.xstatusjv ~
                                    from imtrnarc c join xcodes d on c.zid=d.zid and c.xwh=d.xcode and d.xtype='Branch'
end table
