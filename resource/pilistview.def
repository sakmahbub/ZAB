product ZAB ERP

table pilistview
  caption "PI List View"
  columns zid,xprodtype,xcus,xordernum,xpidate,xlcno,xbuyer,xstatusord,xlineamt
  primary key zid,xprodtype,xcus,xordernum,xpidate,xlcno,xbuyer,xstatusord,xlineamt
  
  foreign key
        zid references zbusiness.zid
		
  end foreign key

  sql create view pilistview(zid,xprodtype,xcus,xordernum,xpidate,xlcno,xbuyer,xstatusord,xlineamt)~
                  as SELECT        b.zid, b.xprodtype, b.xcus, b.xordernum, b.xpidate, b.xlcno, b.xbuyer, b.xstatusord, SUM(a.xlineamt) AS xlineamt ~
			FROM            dbo.oporddetail AS a INNER JOIN ~
                         dbo.opordheader AS b ON a.xordernum = b.xordernum ~
GROUP BY b.zid, b.xprodtype, b.xcus, b.xordernum, b.xpidate, b.xlcno, b.xbuyer, b.xstatusord
end table
