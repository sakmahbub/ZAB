
product ZAB ERP

table pdatview
  caption "OT View"
  columns zid,xyearperdate,xstaff,xtimein,xtimeout,xlncin,xlncout,~
          xwrkhours,xothours,xtype,xdate,xyear,xper,xposition

  primary key zid,xdate,xstaff

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view pdatview (zid,xyearperdate,xstaff,xtimein,xtimeout,xlncin,xlncout,~
          xwrkhours,xothours,xtype,xdate,xyear,xper,xposition)~
                  as select a.zid,a.xyearperdate,a.xstaff,a.xtimein,a.xtimeout,a.xlncin,a.xlncout,~
                  a.xwrkhours,a.xothours,a.xtype,b.xdate,year(b.xdate),month(b.xdate), ~
                  (select xposition from pdmst where pdmst.zid=a.zid and pdmst.xstaff=a.xstaff) ~
                  from pdatdt a join pdathd b on a.zid=b.zid and ~
                  a.xyearperdate=b.xyearperdate where xtype<>'Present'
end table
