product ZAB ERP

table imloandetailview
  caption "IM Loan Header View"

  primary key zid,xloannum

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view imloandetailview(zid,zorg,xloannum,zbid,xtornum,xdate,xrow,xitem,xdesc,xtheircode,xqtyreq,xqtyalc,xunit,xstype,xnote,xlineamt,xsign,xacc) ~
					as select a.xacc,c.xorg,a.xtornum,CAST(d.zid as varchar(20)),d.xtornum,a.xdate,d.xrow,d.xitem,ca.xdesc, ~
					ca.xtheircode,d.xqtyreq,d.xqtyalc,d.xunit,d.xstype,d.xnote,d.xlineamt,~
					case when left(a.xtornum,3)='LRE' then 1 else -1 end,cast(d.zid as varchar(20)) from imtordetail d ~
						join imtorheader a on a.zid=d.zid and a.xtornum=d.xtornum ~
						left join caitem ca on d.zid=ca.zid and d.xitem=ca.xitem ~
						left join cacusview c on a.zid=c.zid and a.xacc=c.xcus ~
						WHERE left(a.xtornum,1)='L' and left(a.xacc,1) not in ('P','S','C') 


end table
