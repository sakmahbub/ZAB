product ZAB

table moreqview
  caption "Payment View"
  columns ztime,zutime,zauserid,zuuserid,zid

  primary key zid,xfm

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view moreqview(zid,xbatch,xrow,xmoprcs,xprcstype,xfabriccolor,xtype,xstatusrec,xqtyreq) ~
  //sql create view moreqview(zid,xbatch,xitemrow,xmoprcs,xfabriccolor,xtype,xstatusrec,xqtyreq) ~
              as select a.zid,a.xbatch,a.xrow,a.xmoprcs,a.xprcstype,a.xfabriccolor,b.xtype,a.xstatusrec,SUM((b.xqtymix+b.xqtyadd)-isnull(b.xqtyreq,0)) ~
              //as select a.zid,a.xbatch,b.xitemrow,a.xmoprcs,a.xfabriccolor,b.xtype,a.xstatusrec,SUM((b.xqtymix+b.xqtyadd)-isnull(b.xqtyreq,0)) ~
			  from mohrecipesetting a ~
			  join mohrecipesettingdetail b ~
			  on a.zid=b.zid ~
			  and a.xbatch=b.xbatch ~
			  and a.xrow=b.xrow ~
			  group by a.zid,a.xbatch,a.xrow,a.xmoprcs,a.xprcstype,a.xfabriccolor,b.xtype,a.xstatusrec ~
			  //group by a.zid,a.xbatch,b.xitemrow,a.xmoprcs,a.xfabriccolor,b.xtype,a.xstatusrec ~
			  HAVING (sum((b.xqtymix+b.xqtyadd)-isnull(b.xqtyreq,0))>0)
end table
