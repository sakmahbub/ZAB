product ZAB ERP

table imloandtpartyview
  caption "IM Loan Header View"

  primary key zid,xloannum

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view imloandtpartyview(zid,zorg,xloannum,xtornum,xdate,xrow,xitem,xdesc,xtheircode,xqtyreq,xqtyalc,xunit,xstype,xnote,xlineamt,xsign,xacc,xtrn) ~
					as select d.zid,c.xorg,a.xtornum,d.xtornum,a.xdate,d.xrow,d.xitem,ca.xdesc, ~
					ca.xtheircode,d.xqtyreq,d.xqtyalc,d.xunit,d.xstype,d.xnote,d.xlineamt, ~
					case when left(a.xtornum,3)='LRE' then 1 else -1 end,a.xacc, ~
					case when left(a.xtornum,3)='LRE' then 'LIS-' else 'LRE-' end ~
						from imtordetail d ~
						join imtorheader a on a.zid=d.zid and a.xtornum=d.xtornum ~
						left join caitem ca on d.zid=ca.zid and d.xitem=ca.xitem ~
						left join cacusview c on a.zid=c.zid and a.xacc=c.xcus ~
						WHERE left(a.xtornum,1)='L' and left(a.xacc,1) in ('P','S','C') 


end table
