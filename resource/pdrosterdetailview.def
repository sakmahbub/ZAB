product ZAB ERP

table pdrosterdetailview
  caption "PD Roster Detail View"
  columns zid,xstaff,xposition,xstatustor,xstatusreq,xwh,xdate
  primary key zid,xstaff,xposition,xstatustor,xstatusreq,xwh,xdate
  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view pdrosterdetailview ( zid,xroster,xrow,xstaff,xshift,xyearperdate,xdate,xshiftimin,xshiftimout,xattimecon,xemptimeout,xnote,xdayname,xtimein,xtimeout,xmin)~
  as Select a.zid,a.xroster,a.xrow,a.xstaff,a.xshift,a.xyearperdate,a.xdate,b.xshiftimin,b.xshiftimout,b.xattimecon,b.xemptimeout,a.xnote,DATENAME (weekday,a.xdate), ~
	CAST(a.xdate+b.xshiftimin as datetime), ~
	CASE WHEN b.xshiftimin>b.xshiftimout THEN CAST(DATEADD(dd,1,a.xdate)+b.xshiftimout as datetime) ELSE CAST(a.xdate+b.xshiftimout as datetime) END,b.xtargetshare ~
	from pdrosterdetail a left join xcodes b on a.zid =b.zid and a.xshift =b.xcode where b.xtype='Shift'
end table
