product ZAB ERP

table poordheaderview
  caption "PO Header View"
  columns zid,xpornum,xlcno,xdisc,xdiscf,xvatrate,xvatamt,xait,xtransport,xbasetransport,xdiscount
  primary zid,xpornum
  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view poordheaderview (zid,xpornum,xlcno,xdisc,xdiscf,xvatrate,xvatamt,xait,xtransport,xbasetransport,xlineamt,xdiscount)~
     as Select a.zid,a.xpornum,a.xlcno,a.xdisc,a.xdiscf,a.xvatrate,a.xvatamt,a.xait,a.xtransport,a.xbasetransport ~
	,isnull((select sum(xlineamt) from poorddetail h where h.zid=a.zid and h.xpornum=a.xpornum group by xpornum),0) ~
	,(isnull((select sum(xlineamt) from poorddetail h where h.zid=a.zid and h.xpornum=a.xpornum group by xpornum),0)*isnull(a.xdisc,0))/100 ~
	from poordheader a
end table
