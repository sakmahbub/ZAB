product ZAB ERP

table grnitemcostview
  caption "PO Item Cost Detail View"
  columns zid,xpornum,xrow,xitem,xdesc,xqtypur,xqtygrn,xlineamt,xotheramt,xrate,xtotamt
  primary zid,xpornum,xrow,xitem,xdesc,xqtypur,xqtygrn,xlineamt,xotheramt,xrate,xtotamt
  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view grnitemcostview (zid,xpornum,xlcno,xitem,xdesc,xqtypur,xrow,xopencost,xdutycost)~ //
                  as Select a.zid,a.xpornum,a.xlcno,b.xitem,c.xdesc,b.xqtypur,b.xrow, ~
				//isnull((select d.xgrnnum from pogrnheader h  join pogrndetail d on h.zid=d.zid and h.xgrnnum=d.xgrnnum WHERE a.zid=h.zid and a.xpornum=d.xpornum and b.xrow=d.xdocrow),''), ~
				//isnull((select d.xqtygrn from pogrnheader h  join pogrndetail d on h.zid=d.zid and h.xgrnnum=d.xgrnnum WHERE a.zid=h.zid and a.xpornum=d.xpornum and b.xrow=d.xdocrow),0), ~
				//isnull((select d.xlineamt from pogrnheader h  join pogrndetail d on h.zid=d.zid and h.xgrnnum=d.xgrnnum WHERE a.zid=h.zid and a.xpornum=d.xpornum and b.xrow=d.xdocrow),0), ~
				//isnull((select d.xbase from pogrnheader h  join pogrndetail d on h.zid=d.zid and h.xgrnnum=d.xgrnnum WHERE a.zid=h.zid and a.xpornum=d.xpornum and b.xrow=d.xdocrow),0), ~
				isnull((select SUM(l.xprime) from lcitemcost l WHERE b.zid=l.zid and b.xpornum=l.xpornum and b.xrow=l.xrow),0), ~
				isnull((select SUM(p.xprime) from pogrnitemcost p join pogrndetail gd on p.zid=gd.zid and p.xgrnnum=gd.xgrnnum and p.xrow=gd.xrow ~
				join pogrnheader gh on gh.zid=gd.zid and gh.xgrnnum=gd.xgrnnum ~
				WHERE gh.zid=a.zid and gd.xpornum=a.xpornum and gd.xdocrow=b.xrow),0) ~
				from poordheader a ~
				join poorddetail b on a.zid=b.zid and a.xpornum=b.xpornum ~
				join caitem c on b.zid=c.zid and b.xitem=c.xitem ~
				where a.xtype='LC' and a.xlcno<>''
end table
