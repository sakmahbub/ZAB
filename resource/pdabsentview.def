
product ZAB ERP

table pdabsentview
  caption "OT View"
  columns zid,xyearperdate,xstaff,xtype,xdate,xyear,xper,xday,xposition

  primary key zid,xdate,xstaff

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view pdabsentview (zid,xyearperdate,xstaff,xtype,xdate,xyear,xper,xday)~
                  as select a.zid,a.xyearperdate,a.xstaff,'Absent',b.xdate,year(b.xdate),~
                  month(b.xdate),xday from pdabsentdetail a join pdabsent b on a.zid=b.zid and ~
                  a.xyearperdate=b.xyearperdate union all ~
                  //*** suspend ***
                  select a.zid,a.xyearperdate,a.xstaff,'Suspend',a.xdate,a.xyear,month(a.xdate),1 ~
                  from pdleavedetail a join pdleaveheader b on a.zid=b.zid and a.xyearperdate=b.xyearperdate ~
                  where b.xtypeleave='Suspend' union all ~
                  //*** LWP ***
                  select a.zid,a.xyearperdate,a.xstaff,'LWP',a.xdate,a.xyear,month(a.xdate),1 ~
                  from pdleavedetail a join pdleaveheader b on a.zid=b.zid and a.xyearperdate=b.xyearperdate ~
                  where b.xtypeleave='Leave Without Pay'
end table
