product ZAB ERP

table opdociforarview
  caption "PI Report View"
  columns 	zid,ztime,xinvnum,xinvdate,xstatusar,xstatusjv,xvoucher,xlineamt,xdornum,xcus,xdate,xordernum,xlcno,xstatusdor,xlineamtsum
 
 primary key zid,xinvnum,xdornum

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view opdociforarview (zid,ztime,xinvnum,xinvdate,xstatusar,xstatusjv,xvoucher,xlineamtsum,xdornum,xcus,xdate,xordernum,xlcno,xstatusdor,xlineamt) ~
					 as  SELECT  b.zid, b.ztime, a.xinvnum, a.xdate AS xinvdate ,a.xstatusar, a.xstatusjv, ISNULL(b.xvoucher,''),~ 
						 ISNULL ((SELECT     SUM(xlineamt) AS Expr2  FROM     dbo.opinvdetail AS c ~
                          WHERE     (xinvnum = a.xinvnum)), 0) AS xlineamt, b.xdornum, b.xcus, b.xdate, b.xordernum, b.xlcno, b.xstatusdor,~ 
				  ISNULL   ((SELECT     SUM(xlineamt) AS Expr1   FROM   dbo.opdodetail AS c ~
                            WHERE     (xdornum = b.xdornum)), 0) AS xlineamtsum ~
			FROM         dbo.opinvheader AS a ~
			INNER JOIN dbo.opdoheader AS b ON a.zid = b.zid AND a.xinvnum = b.xinvnum


end table

