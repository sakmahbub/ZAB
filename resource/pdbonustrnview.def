
product ZAB ERP

table pdbonustrnview
  caption "Leave View"
  columns zid,xvoucher,xrow,xyear,xper,xdate,xstaff,xtype,xamount,xpercent,xqty,xtrntype,xlong,xposition

  primary key zid,xvoucher,xrow

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view pdbonustrnview (zid,xvoucher,xrow,xyear,xper,xdate,xstaff,xtype,xamount,xpercent,xqty,xtrntype,xlong,xposition)~
                  as select a.zid,a.xvoucher,a.xrow,b.xyear,b.xper,b.xdate,b.xstaff,a.xtype,a.xamount,~
                  a.xpercent,a.xqty,~
                  (select xprops from xcodes where a.zid=xcodes.zid and xtype='PD Transaction Type' and xcode=a.xtype), ~
                  (select xlong from xcodes where a.zid=xcodes.zid and xtype='PD Transaction Type' and xcode=a.xtype),~
                  (select pdmst.xposition from pdmst where pdmst.zid=b.zid and pdmst.xstaff=b.xstaff) ~
                  from pdtrndetail a join pdtrnheader b on a.zid=b.zid and a.xvoucher=b.xvoucher
end table
