


product ZAB ERP

table mgnprdwisesalesdashboardview
  caption "PO View"
  primary zid,xpornum,xrow,xgitem,xitem,xdesc,xchassisno,xaccdr,xdes1,xacccr,xdes2,xprime,xstatusjv,xtype,xrow
  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view mgnprdwisesalesdashboardview (zid,xyear,xper,xqty,xval)~
                  as select a.zid,CASE WHEN 12+month(a.xdate)-ac.xoffset<=12 THEN year(a.xdate)-1 ELSE year(a.xdate) END,~
				  CASE WHEN 12+month(a.xdate)-ac.xoffset>12 THEN month(a.xdate)-ac.xoffset ELSE 12+month(a.xdate)-ac.xoffset END,sum(a.xqty),sum(a.xval) ~
				  FROM imtrn a ~
				  JOIN acdef ac ~
				  ON a.zid=ac.zid ~
				  WHERE left(ximtrnnum,2)='OP' ~
					
				  GROUP BY a.zid,CASE WHEN 12+month(a.xdate)-ac.xoffset<=12 THEN year(a.xdate)-1 ELSE year(a.xdate) END,~
				  CASE WHEN 12+month(a.xdate)-ac.xoffset>12 THEN month(a.xdate)-ac.xoffset ELSE 12+month(a.xdate)-ac.xoffset END
					
end table
