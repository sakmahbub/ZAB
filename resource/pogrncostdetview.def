


product ZAB ERP

table pogrncostdetview
  caption "PO Item Cost Detail View"
  columns zid,xcus,xgrnnum,xpornum,xlcno,xrow,xdocrow,xitem,xdesc,xchassisno,xcur,xexch,xcurbuyer,xexchbuyer,xttcur,xttexch, ~
							xqtygrn,xlineamt,xbase,xprimebuyer,xttamount,xttbase,xttbuyer,xbuyeramt,xcnfamt,xinsamt,xcusduty,xseafrdamt,xcusmisc,xcarriageind,xinlandamt,xothercost,xopencost,xprimetotamt,xprime
  primary zid,xcus,xgrnnum,xpornum,xlcno,xrow,xdocrow,xitem,xdesc,xchassisno,xcur,xexch,xcurbuyer,xexchbuyer,xttcur,xttexch, ~
							xqtygrn,xlineamt,xbase,xprimebuyer,xttamount,xttbase,xttbuyer,xbuyeramt,xcnfamt,xinsamt,xcusduty,xseafrdamt,xcusmisc,xcarriageind,xinlandamt,xothercost,xopencost,xprimetotamt,xprime
  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view pogrncostdetview (zid,xcus,xgrnnum,xpornum,xlcno,xrow,xdocrow,xitem,xdesc,xchassisno,xcur,xexch,xcurbuyer,xexchbuyer,xttcur,xttexch, ~
							xqtygrn,xlineamt,xbase,xprimebuyer,xttamount,xttbase,xttbuyer,xbuyeramt,xcnfamt,xinsamt,xcusduty,xseafrdamt,xcusmisc,xcarriageind,xinlandamt,xothercost,xopencost,xprimetotamt,xprime) ~
                as Select a.zid,a.xcus,a.xgrnnum,a.xpornum,a.xlcno,b.xrow,b.xdocrow,b.xitem,c.xdesc,isnull(b.xchassisno,''),a.xcur,a.xexch,a.xcurbuyer,a.xexchbuyer,a.xttcur,a.xttexch, ~
				b.xqtygrn,isnull(b.xlineamt,0) as lineamt,Case When isnull(b.xbase,0)=0 THEN b.xlineamt Else b.xbase end  as BaseAmt,isnull(xprimebuyer,0) as LCbuyer, ~
				isnull(b.xttamount,0) as OtherAmt,isnull(xttbase,0) as OtherBase,isnull(xttbuyer,0) as OtherBuyer,isnull(xbuyeramt,0) as xbuyeramt, ~
				(select isnull(sum(gd.xprime),0) from pogrndutypayment gd where b.zid=gd.zid and b.xgrnnum=gd.xgrnnum and b.xrow=gd.xrow and gd.xaccdr='1105204') as cnf, ~
				//((select isnull(sum(gd1.xprime),0) from pogrndutypayment gd1 where b.zid=gd1.zid and b.xgrnnum=gd1.xgrnnum and b.xrow=gd1.xrow and gd1.xaccdr='1105205')+ ~
				 (ISNULL((select ISNULL(SUM(l2.xprime),0) from lcitemcost l2 where a.zid=l2.zid and a.xpornum=l2.xpornum and b.xdocrow=l2.xrow and l2.xaccdr='1105205' and l2.xstatusjv='Open'),0)+ ~
				 (select isnull(sum(acbl.xprime),0) from acbal acbl where b.zid=acbl.zid and a.xlcno=acbl.xlcno and b.xchassisno=acbl.xchassisno and acbl.xacc='1105205')) as Insurance, ~
				(select isnull(sum(gd2.xprime),0) from pogrndutypayment gd2 where b.zid=gd2.zid and b.xgrnnum=gd2.xgrnnum and b.xrow=gd2.xrow and gd2.xaccdr='1105206') as CustomsDuty, ~
				(select isnull(sum(gd3.xprime),0) from pogrndutypayment gd3 where b.zid=gd3.zid and b.xgrnnum=gd3.xgrnnum and b.xrow=gd3.xrow and gd3.xaccdr='1105212') as SeaFreightHandingCost, ~
				(select isnull(sum(gd4.xprime),0) from pogrndutypayment gd4 where b.zid=gd4.zid and b.xgrnnum=gd4.xgrnnum and b.xrow=gd4.xrow and gd4.xaccdr='1105213') as CustomsMiscAssesmen, ~
				((select isnull(sum(gd5.xprime),0) from pogrndutypayment gd5 where b.zid=gd5.zid and b.xgrnnum=gd5.xgrnnum and b.xrow=gd5.xrow and gd5.xaccdr='1105214' and xstatusjv='Open')+ ~
				 (select isnull(sum(acb.xprime),0) from acbal acb where b.zid=acb.zid and a.xlcno=acb.xlcno and b.xchassisno=acb.xchassisno and acb.xacc='1105214')) as CarriageInward, ~
				(select isnull(sum(gd6.xprime),0) from pogrndutypayment gd6 where b.zid=gd6.zid and b.xgrnnum=gd6.xgrnnum and b.xrow=gd6.xrow and gd6.xaccdr='1105215') as InlandTransport, ~
				(select isnull(sum(gd7.xprime),0) from pogrndutypayment gd7 where b.zid=gd7.zid and b.xgrnnum=gd7.xgrnnum and b.xrow=gd7.xrow and gd7.xaccdr not in ('1105215','1105214','1105213','1105212','1105206','1105205','1105204')) as OtherCost, ~
				ISNULL((select ISNULL(SUM(l.xprime),0) from lcitemcost l where a.zid=l.zid and a.xpornum=l.xpornum and b.xdocrow=l.xrow and l.xaccdr<>'1105205'),0) as OpeningCost, ~
				ISNULL((select ISNULL(SUM(pod.xlineamt),0) from poorddetail pod where a.zid=pod.zid and a.xpornum=pod.xpornum),0) as xprimetotamt, ~
				ISNULL((select ISNULL(SUM(pod1.xlineamt),0) from poorddetail pod1 where a.zid=pod1.zid and a.xpornum=pod1.xpornum and (pod1.xqtypur-pod1.xqtygrn)=0),0) as xprime ~
				from pogrnheader a ~
				join pogrndetail b on a.zid=b.zid and a.xgrnnum=b.xgrnnum ~
				join caitem c on b.zid=c.zid and b.xitem=c.xitem ~
				where isnull(b.xchassisno,'')<>''
end table
