
product ZAB ERP

table pdbonusbalview
  caption "Balance View"
  columns zid,xstaff,xname,xdesignation,xcode,xdeptname,xyear,xper,xtype,xamount,~
          xtrntype,xbank,xacc,xposition,xempcategory,xdatejoin,xenddate,xcomtype,xbatch

  primary key zid,xyear,xper,xstaff

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view pdbonusbalview (zid,xstaff,xname,xdesignation,xcode,xdeptname,xyear,xper,xtype,~
                  xamount,xtrntype,xbank,xacc,xposition,xempcategory,xdatejoin,xenddate,xcomptype,xbatch) ~
                  as select a.zid,a.xstaff,b.xname,b.xdesignation,b.xdeptname,~
                  (select xlong from xcodes where xtype='Department Name' and a.zid=xcodes.zid and xcode=b.xdeptname), ~
                  a.xyear,a.xper,a.xtype,a.xamount,~
                  (select xprops from xcodes where xtype='PD Transaction Type' and a.zid=xcodes.zid and xcode=a.xtype),~
                  b.xbank,b.xacc,a.xposition,a.xempcategory,b.xdatejoin,b.xenddate,~
		              (select xlong from xcodes where xcodes.zid=a.zid and xtype='PD Transaction Type' and xcode=a.xtype), ~
		              isnull(b.xbatch,'') ~	

                  from pdbonusbal a join pdmst b on a.zid=b.zid and a.xstaff=b.xstaff
end table
