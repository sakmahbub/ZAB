product ZAB

table opdtsumview
  caption "Actual Sales Detail"
  columns ztime,zutime,zauserid,zuuserid,zid

  primary key zid,xdornum

  foreign key
        zid references zbusiness.zid
        //zid,xsm,xrsm references carsm.zid,xsm,xrsm
  end foreign key

  sql create view opdtsumview(zid,xdate,xdornum,xitem,xdesc,xpacking,xsumnum,xwh,xrate,xqtyord,xqty,xqtytr,xqtybonus) ~
	as select hd.zid,hd.xdate,hd.xdornum,dt.xitem,ca.xdesc,dt.xpacking,hd.xsumnum,hd.xwh,dt.xrate,(dt.xqtyord+dt.xqtybonus),~
	isnull(temptable.xqtyord,0) as xqty,dt.xqtytr,dt.xqtybonus ~
	from opdoheader hd ~
	inner join opdodetail dt on hd.zid=dt.zid and hd.xdornum=dt.xdornum ~
	inner join caitem ca on dt.zid=ca.zid and dt.xitem=ca.xitem ~
	left join ~
	(select ch.zid,ch.xdate,ch.xordernum,cd.xitem,(isnull(cd.xqtyord,0)+isnull(cd.xqtybonus,0)) as xqtyord from opcrnheader ch ~
	inner join opcrndetail cd on ch.zid=cd.zid and ch.xcrnnum=cd.xcrnnum) temptable on temptable.zid=hd.zid and ~
 	hd.xdornum=temptable.xordernum and temptable.xitem=dt.xitem

end table
