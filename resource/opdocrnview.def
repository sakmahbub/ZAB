product ZAB ERP

table opdocrnview
  caption "OP DO CRN View"

columns zid,xdornum,xcrnnum,xdate,xcus,xstatusord,xwh,xstatusar,xtotamt,xref,xnote,~
		xvatamt,xdiscamt,xfm,xsm,xrsm,xsp,xpp,xqtytr,xqtycrn,xdisctype,xsprate,xnetamt,xqtybntr,xdiscdetamttr,xvatamttr,xnetamttr,~
		xrow,xitem,xqtyord,xunit,xrate,xlineamt,xvatrate,xdiscdetamt,xqtybonus,xdatecom,xdatedue,xterritory,xcost,xsign,xyear,xper,xfield,~
		xregion,xmarket,xtype,xpacking,xroute,xstatus,xprime,xdatepo,xdeltime,xdatedel,xsumnum,xexpamt


  primary key zid,xvoucher

  foreign key
        zid references zbusiness.zid
  end foreign key

  sql create view opdocrnview(zid,xdornum,xcrnnum,xdate,xcus,xstatusord,xwh,xstatusar,xtotamt,xref,xnote,~
		xvatamt,xdiscamt,xfm,xsm,xrsm,xsp,xpp,xqtytr,xqtycrn,xdisctype,xsprate,xnetamt,xqtybntr,xdiscdetamttr,xvatamttr,xnetamttr,~
		xrow,xitem,xqtyord,xunit,xrate,xlineamt,xvatrate,xdiscdetamt,xqtybonus,xdatecom,xdatedue,xterritory,xcost,xsign,xarea,xpaymentterm,xyear,xper,xfield,~
		xregion,xmarket,xtype,xpacking,xroute,xstatus,xprime,xdatepo,xdeltime,xdatedel,xsumnum,xexpamt) ~
	as select a.zid,a.xdornum,a.xcrnnum,a.xdate,a.xcus,a.xstatusord,a.xwh,a.xstatusar,a.xtotamt,a.xref,a.xnote,~
	a.xvatamt,a.xdiscamt,a.xfm,a.xsm,a.xrsm,a.xsp,a.xpp,b.xqtytr,b.xqtycrn,b.xdisctype,b.xsprate,b.xnetamt,b.xqtybntr,~
	b.xdiscdetamttr,b.xvatamttr,b.xnetamttr,~
	b.xrow,b.xitem,b.xqtyord,b.xunit,b.xrate,b.xlineamt,b.xvatrate,b.xdiscdetamt,b.xqtybonus,~
	a.xdatecom,a.xdatedue,a.xterritory,b.xcost,1,a.xarea,a.xpaymentterm,a.xyear,a.xper,~
	isnull(a.xfield,''),isnull(a.xregion,''),isnull(a.xmarket,''),a.xtype,b.xpacking,a.xroute,a.xstatus,a.xprime,~
	a.xdatepo,a.xdeltime,a.xdatedel,a.xsumnum,a.xexpamt from opdoheader a join opdodetail b on a.zid=b.zid and a.xdornum=b.xdornum ~
union all ~
	select p.zid,p.xdornum,p.xcrnnum,p.xdate,p.xcus,p.xstatusord,p.xwh,p.xstatusar,p.xtotamt,p.xref,p.xnote,~
	p.xvatamt,p.xdiscamt,p.xfm,p.xsm,p.xrsm,p.xsp,p.xpp,o.xqtytr,o.xqtycrn,o.xdisctype,o.xsprate,o.xnetamt,o.xqtybntr,~
	o.xdiscdetamttr,o.xvatamttr,o.xnetamttr,o.xrow,o.xitem,o.xqtyord,o.xunit,o.xrate,o.xlineamt,o.xvatrate,o.xdiscdetamt,o.xqtybonus,~
	p.xdatecom,p.xdatedue,p.xterritory,o.xcost,1,p.xarea,p.xpaymentterm,p.xyear,p.xper,isnull(p.xfield,''),isnull(p.xregion,''),p.xmarket,p.xtype,o.xpacking,~
    p.xroute,p.xstatus,p.xprime,p.xdatepo,p.xdeltime,p.xdatedel,p.xsumnum,p.xexpamt from opdodetailarc o join opdoheaderarc p on o.zid=p.zid and o.xdornum=p.xdornum 

end table
